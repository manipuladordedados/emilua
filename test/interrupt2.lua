fib = spawn(function()
    fib:interrupt()
    fib:detach()
    print('foo')
    coroutine.wrap(function() this_fiber.yield() end)()
    print('bar')
end)
